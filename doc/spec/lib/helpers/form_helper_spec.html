<!DOCTYPE html>

<html>
<head>
  <title>form_helper_spec.rb</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>form_helper_spec.rb</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">require</span> <span class="hljs-string">'spec_helper'</span>
<span class="hljs-keyword">require</span> <span class="hljs-string">'helpers/form_helper'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>request mock returns an fake path</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestMock</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">path</span></span>
    <span class="hljs-string">'users/request'</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>mock object for form_for or field_for</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMock</span></span>
  <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:name</span>, <span class="hljs-symbol">:age</span>, <span class="hljs-symbol">:sex</span>, <span class="hljs-symbol">:hobby</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>def errors
  { age: ‘age has error’, messages: { age: ‘age has error’ } }
end</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>mock the form helper</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormMock</span></span>
  <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:params</span>
  <span class="hljs-keyword">include</span> <span class="hljs-constant">FormHelper</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">request</span></span>
    <span class="hljs-constant">RequestMock</span>.new
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">params</span></span>
    <span class="hljs-variable">@params</span> ||= {}
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>rubocop:disable all</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>describe <span class="hljs-constant">FormHelper</span> <span class="hljs-keyword">do</span>
  subject { <span class="hljs-constant">FormMock</span>.new }

  describe <span class="hljs-string">'#hash_to_html_attrs'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'render hash to attr list'</span> <span class="hljs-keyword">do</span>
      expect(subject.hash_to_html_attrs(<span class="hljs-symbol">ab:</span> <span class="hljs-string">'cd'</span>, <span class="hljs-symbol">ef:</span> <span class="hljs-string">'D'</span>))
        .to eq(<span class="hljs-string">'ab="cd" ef="D"'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'do not render key with nil value'</span> <span class="hljs-keyword">do</span>
      expect(subject.hash_to_html_attrs(<span class="hljs-string">'ab'</span> =&gt; <span class="hljs-string">'cd'</span>, <span class="hljs-string">'ef'</span> =&gt; <span class="hljs-string">'D'</span>, <span class="hljs-string">'hijk'</span> =&gt; <span class="hljs-keyword">nil</span>))
        .to eq(<span class="hljs-string">'ab="cd" ef="D"'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'render a key-only attribute for a special :empty value'</span> <span class="hljs-keyword">do</span>
      expect(subject.hash_to_html_attrs(<span class="hljs-string">'ab'</span> =&gt; <span class="hljs-string">'cd'</span>, <span class="hljs-string">'ef'</span> =&gt; <span class="hljs-string">'D'</span>, <span class="hljs-string">'hijk'</span> =&gt; <span class="hljs-symbol">:empty</span>))
        .to eq(<span class="hljs-string">'ab="cd" ef="D" hijk'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#single_tag'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create tag with options'</span> <span class="hljs-keyword">do</span>
      expect(subject.single_tag(<span class="hljs-symbol">:some</span>, { <span class="hljs-symbol">a:</span> <span class="hljs-string">'b'</span> })).to eq(<span class="hljs-string">"&lt;some a=\"b\" /&gt;"</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create tag without options'</span> <span class="hljs-keyword">do</span>
      expect(subject.single_tag(<span class="hljs-symbol">:some</span>)).to eq(<span class="hljs-string">'&lt;some /&gt;'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#tag'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a tag without options and contents'</span> <span class="hljs-keyword">do</span>
      expect(subject.tag(<span class="hljs-symbol">:some</span>)).to eq(<span class="hljs-string">'&lt;some&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a tag without options and contents'</span> <span class="hljs-keyword">do</span>
      expect(subject.tag(<span class="hljs-symbol">:some</span>, <span class="hljs-string">'name in'</span>)).to eq(<span class="hljs-string">'&lt;some&gt;name in&lt;/some&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a tag without options and contents'</span> <span class="hljs-keyword">do</span>
      expect(subject.tag(<span class="hljs-symbol">:some</span>, <span class="hljs-string">'age'</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-string">'n'</span> })).to eq(<span class="hljs-string">'&lt;some f="n"&gt;age&lt;/some&gt;'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#form'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'returns form tag for simple call'</span> <span class="hljs-keyword">do</span>
      expect(subject.form).to eq(<span class="hljs-string">%q(&lt;form action="/users/request" method="POST"&gt;)</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'or a call for ":self"'</span> <span class="hljs-keyword">do</span>
      expect(subject.form(<span class="hljs-symbol">:self</span>)).to eq(subject.form)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'can create get form'</span> <span class="hljs-keyword">do</span>
      expect(subject.form(<span class="hljs-symbol">:self</span>, { <span class="hljs-symbol">method:</span> <span class="hljs-symbol">:get</span> }))
        .to eq(<span class="hljs-string">%q(&lt;form action="/users/request" method="GET"&gt;)</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'can mimic a delete form'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/request" method="POST"&gt;&lt;input type=)</span> +
            <span class="hljs-string">%q("hidden" name="_method" id="_method" value="DELETE" /&gt;)</span>
      expect(subject.form(<span class="hljs-symbol">:self</span>, { <span class="hljs-symbol">method:</span> <span class="hljs-symbol">:delete</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'can rsltlicitly specify an action'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/send-out" method="POST"&gt;)</span>
      expect(subject.form(<span class="hljs-string">'/send-out'</span>)).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'can create an upload form with data type'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/request" method="POST" )</span> +
            <span class="hljs-string">%q(enctype="multipart/form-data"&gt;)</span>
      expect(subject.form(<span class="hljs-symbol">:self</span>, <span class="hljs-symbol">upload:</span> <span class="hljs-keyword">true</span>)).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a form for an object'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/update" method="POST"&gt;&lt;/form&gt;)</span>
      expect(subject.form_for(<span class="hljs-constant">UserMock</span>.new, <span class="hljs-string">'/users/update'</span>) { |u| } ).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create an upload for an object'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/update" method="POST" )</span> +
             <span class="hljs-string">%q(enctype="multipart/form-data"&gt;&lt;/form&gt;)</span>
      expect(subject.form_for(<span class="hljs-constant">UserMock</span>.new, <span class="hljs-string">'/users/update'</span>, <span class="hljs-symbol">upload:</span> <span class="hljs-keyword">true</span>) { |u| } ).to eq(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#fieldset'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create an open fieldset tag'</span> <span class="hljs-keyword">do</span>
      expect(subject.fieldset).to eq(<span class="hljs-string">'&lt;fieldset&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create an open fieldset with legend'</span> <span class="hljs-keyword">do</span>
      expect(subject.fieldset(<span class="hljs-string">'user'</span>)).to eq(<span class="hljs-string">'&lt;fieldset&gt;&lt;legend&gt;user&lt;/legend&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a fieldset for user'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;fieldset&gt;&lt;legend&gt;user&lt;/legend&gt;&lt;/fieldset&gt;'</span>
      expect(subject.fieldset_for(<span class="hljs-constant">UserMock</span>.new, <span class="hljs-symbol">:user_mock</span>, <span class="hljs-string">'user'</span>) { |u| }).to eq(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#form_for'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'set default value from object'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'John Simth'</span>, <span class="hljs-number">18</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/request" method="POST"&gt;)</span> +
             <span class="hljs-string">%q(&lt;input type="hidden" name="user_mock[name]" )</span> +
             <span class="hljs-string">%q(id="user_mock_name" value="John Simth" /&gt;&lt;/form&gt;)</span>
      expect(subject.form_for(user) { |f| f.hidden <span class="hljs-symbol">:name</span> }).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set default value from object'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">user_mock:</span> { <span class="hljs-symbol">name:</span> <span class="hljs-string">'Paul Adams'</span> } }
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'John Simth'</span>, <span class="hljs-number">18</span>
      rslt = <span class="hljs-string">%q(&lt;form action="/users/request" method="POST"&gt;)</span> +
             <span class="hljs-string">%q(&lt;input type="hidden" name="user_mock[name]" )</span> +
             <span class="hljs-string">%q(id="user_mock_name" value="Paul Adams" /&gt;&lt;/form&gt;)</span>
      expect(subject.form_for(user) { |f| f.hidden <span class="hljs-symbol">:name</span> }).to eq(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#fieldset_for'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'wrap a object inside an field set block'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">18</span>
      rslt = subject.form { subject.fieldset_for(user) { |f| f.hidden <span class="hljs-symbol">:name</span> } }
      expect(rslt).to match(<span class="hljs-string">'&lt;fieldset&gt;&lt;legend&gt;UserMock&lt;/legend&gt;'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;/fieldset&gt;'</span>)
      expect(rslt).to match(<span class="hljs-string">'Henry Simson'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set params value to the field set'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">user_mock:</span> { <span class="hljs-symbol">name:</span> <span class="hljs-string">'Alfred Ford'</span> } }
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">18</span>
      rslt = subject.form { subject.fieldset_for(user) { |f| f.hidden <span class="hljs-symbol">:name</span> } }
      expect(rslt).to match(<span class="hljs-string">'&lt;fieldset&gt;&lt;legend&gt;UserMock&lt;/legend&gt;'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;/fieldset&gt;'</span>)
      expect(rslt).to_not match(<span class="hljs-string">'Henry Simson'</span>)
      expect(rslt).to match(<span class="hljs-string">'Alfred Ford'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#text'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create an text input tag with default value from param'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">login_id:</span> <span class="hljs-string">'logme@email.com'</span> }
      rslt = <span class="hljs-string">'&lt;input type="text" name="login_id" id="login_id" '</span> +
             <span class="hljs-string">'value="logme@email.com" /&gt;'</span>
      expect(subject.text(<span class="hljs-symbol">:login_id</span>)).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create an text input tag within an form for block'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">30</span>
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        <span class="hljs-variable">@out</span> = <span class="hljs-string">''</span>
        <span class="hljs-variable">@out</span> &lt;&lt; f.text(<span class="hljs-symbol">:name</span>)
        <span class="hljs-variable">@out</span> &lt;&lt; f.text(<span class="hljs-symbol">:age</span>)
      <span class="hljs-keyword">end</span>
      expect(rslt).to match(<span class="hljs-string">'&lt;input type="text" name="user_mock\[name\]"'</span>)
      expect(rslt).to match(<span class="hljs-string">'value="Henry Simson"'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;input type="text" name="user_mock\[age\]"'</span>)
      expect(rslt).to match(<span class="hljs-string">'value="30"'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#label'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a label for a specific field'</span> <span class="hljs-keyword">do</span>
      expect(subject.label(<span class="hljs-symbol">:user_name</span>, <span class="hljs-string">'User Name'</span>))
        .to eq(<span class="hljs-string">'&lt;label for="user_name"&gt;User Name&lt;/label&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a label inside an form for'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">30</span>
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        <span class="hljs-variable">@out</span> = <span class="hljs-string">''</span>
        <span class="hljs-variable">@out</span> &lt;&lt; f.label(<span class="hljs-symbol">:name</span>, <span class="hljs-string">'User Name'</span>)
        <span class="hljs-variable">@out</span> &lt;&lt; f.text(<span class="hljs-symbol">:name</span>)
      <span class="hljs-keyword">end</span>
      expect(rslt).to match(<span class="hljs-regexp">/&lt;label for="user_mock_name"&gt;User Name&lt;\/label&gt;/</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a label inside an field for'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">30</span>
      rslt = subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(user) <span class="hljs-keyword">do</span> |f|
          <span class="hljs-variable">@out</span> = <span class="hljs-string">''</span>
          <span class="hljs-variable">@out</span> &lt;&lt; f.label(<span class="hljs-symbol">:name</span>, <span class="hljs-string">'User Name'</span>)
          <span class="hljs-variable">@out</span> &lt;&lt; f.text(<span class="hljs-symbol">:name</span>)
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>
      expect(rslt).to match(<span class="hljs-regexp">/&lt;label for="user_mock_name"&gt;User Name&lt;\/label&gt;/</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#password'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create an password input tag within an form for block'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name, user.age = <span class="hljs-string">'Henry Simson'</span>, <span class="hljs-number">30</span>
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        <span class="hljs-variable">@out</span> = <span class="hljs-string">''</span>
        <span class="hljs-variable">@out</span> &lt;&lt; f.text(<span class="hljs-symbol">:name</span>)
        <span class="hljs-variable">@out</span> &lt;&lt; f.password(<span class="hljs-symbol">:password</span>)
      <span class="hljs-keyword">end</span>
      expect(rslt).to match(<span class="hljs-string">'&lt;input type="text" name="user_mock\[name\]"'</span>)
      expect(rslt).to match(<span class="hljs-string">'value="Henry Simson"'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;input type="password" name="user_mock\[password\]"'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#submit'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a submit tag with default values'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="submit" name="submit" id="submit" value="Submit" /&gt;'</span>
      expect(subject.submit).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a sumibt tag within a form_for block'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      rslt = <span class="hljs-string">'&lt;input type="submit" name="submit" id="submit" value="Submit" /&gt;'</span>
      expect(subject.form_for(user) { |f| f.submit }).to match(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a submit tag with specific name and value'</span> <span class="hljs-keyword">do</span>
      u = <span class="hljs-constant">UserMock</span>.new
      rslt = <span class="hljs-string">'&lt;input type="submit" name="submit" id="submit" value="Go" /&gt;'</span>
      expect(subject.form_for(u) { |f| f.submit(<span class="hljs-string">'Go'</span>) }).to match(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a submit tag with name value inside field set'</span> <span class="hljs-keyword">do</span>
      u = <span class="hljs-constant">UserMock</span>.new
      rslt = <span class="hljs-string">'&lt;input type="submit" name="update" id="update" value="Go" /&gt;'</span>
      expect(subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(u) <span class="hljs-keyword">do</span> |f|
          f.submit(<span class="hljs-string">'Go'</span>, <span class="hljs-symbol">name:</span> <span class="hljs-string">'update'</span>)
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>).to match(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#button'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a button with default values'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="button" name="button" id="button" value="Button" /&gt;'</span>
      expect(subject.button).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a button with name value inside field set'</span> <span class="hljs-keyword">do</span>
      u = <span class="hljs-constant">UserMock</span>.new
      rslt = <span class="hljs-string">'&lt;input type="button" name="update" id="update" value="Setup" /&gt;'</span>
      expect(subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(u) <span class="hljs-keyword">do</span> |f|
          f.button(<span class="hljs-string">'Setup'</span>, <span class="hljs-symbol">name:</span> <span class="hljs-string">'update'</span>)
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>).to match(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#reset'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a Reset with name value inside field set'</span> <span class="hljs-keyword">do</span>
      u = <span class="hljs-constant">UserMock</span>.new
      rslt = <span class="hljs-string">'&lt;input type="reset" name="update" id="update" value="Go" /&gt;'</span>
      expect(subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(u) <span class="hljs-keyword">do</span> |f|
          f.reset(<span class="hljs-string">'Go'</span>, <span class="hljs-symbol">name:</span> <span class="hljs-string">'update'</span>)
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>).to match(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#textarea'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a plain textarea'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;textarea name="body" id="body" col="30"&gt;body string&lt;/textarea&gt;'</span>
      expect(subject.textarea(<span class="hljs-string">'body'</span>, <span class="hljs-string">'body string'</span>, { <span class="hljs-symbol">col:</span> <span class="hljs-number">30</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create a textarea inside a form'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;textarea name="user_mock\[body\]" id="user_mock_body"'</span> +
             <span class="hljs-string">' col="30"&gt;body string&lt;/textarea&gt;'</span>
      expect(subject.form_for(<span class="hljs-constant">UserMock</span>.new) <span class="hljs-keyword">do</span> |f|
        f.textarea(<span class="hljs-string">'body'</span>, <span class="hljs-string">'body string'</span>, { <span class="hljs-symbol">col:</span> <span class="hljs-number">30</span> })
      <span class="hljs-keyword">end</span>).to match(rslt)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#radio'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create radio with one key'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_f" value="f" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_f"&gt;f&lt;/label&gt;'</span>
      expect(subject.radio(<span class="hljs-symbol">:sex</span>, <span class="hljs-symbol">:f</span>)).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create radioes with array'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_f" value="f" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_f"&gt;f&lt;/label&gt; '</span> +
             <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_m" value="m" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_m"&gt;m&lt;/label&gt;'</span>
      expect(subject.radio(<span class="hljs-symbol">:sex</span>, [<span class="hljs-symbol">:f</span>, <span class="hljs-string">'m'</span>])).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create radioes with hash'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_f" value="f" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_f"&gt;Famale&lt;/label&gt; '</span> +
             <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_m" value="m" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_m"&gt;Male&lt;/label&gt;'</span>
      expect(subject.radio(<span class="hljs-symbol">:sex</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-symbol">:Famale</span>, <span class="hljs-symbol">m:</span> <span class="hljs-symbol">:Male</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set default values from params'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">sex:</span> <span class="hljs-symbol">:m</span> }
      rslt = <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_f" value="f" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="sex_f"&gt;Famale&lt;/label&gt; '</span> +
             <span class="hljs-string">'&lt;input type="radio" name="sex" id="sex_m" value="m" '</span> +
             <span class="hljs-string">'checked="checked" /&gt; &lt;label for="sex_m"&gt;Male&lt;/label&gt;'</span>
      expect(subject.radio(<span class="hljs-symbol">:sex</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-symbol">:Famale</span>, <span class="hljs-symbol">m:</span> <span class="hljs-symbol">:Male</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create radio inside form for'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.sex = <span class="hljs-symbol">:m</span>
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        f.radio <span class="hljs-symbol">:sex</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-symbol">:Famale</span>, <span class="hljs-symbol">m:</span> <span class="hljs-symbol">:Male</span> }
      <span class="hljs-keyword">end</span>
      inp = <span class="hljs-string">'&lt;input type="radio" name="user_mock\[sex\]" '</span>
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_f\" value="f" /&gt;'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_m\" value="m" checked'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'create radio inside fieldset'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.sex = <span class="hljs-symbol">:f</span>
      rslt = subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(user) <span class="hljs-keyword">do</span> |f|
          f.radio <span class="hljs-symbol">:sex</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-symbol">:Famale</span>, <span class="hljs-symbol">m:</span> <span class="hljs-symbol">:Male</span> }
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>
      inp = <span class="hljs-string">'&lt;input type="radio" name="user_mock\[sex\]" '</span>
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_f\" value="f" checked'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_m\" value="m" /&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'prefers params for form_for'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.sex = <span class="hljs-symbol">:f</span>
      subject.params = { <span class="hljs-symbol">user_mock:</span> { <span class="hljs-symbol">sex:</span> <span class="hljs-symbol">:m</span> } }
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        f.radio <span class="hljs-symbol">:sex</span>, { <span class="hljs-symbol">f:</span> <span class="hljs-symbol">:Famale</span>, <span class="hljs-symbol">m:</span> <span class="hljs-symbol">:Male</span> }
      <span class="hljs-keyword">end</span>
      inp = <span class="hljs-string">'&lt;input type="radio" name="user_mock\[sex\]" '</span>
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_f\" value="f" /&gt;'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'id=\"user_mock_sex_m\" value="m" checked'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#checkbox'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create a single valued checkbox'</span> <span class="hljs-keyword">do</span>
      rslt = <span class="hljs-string">'&lt;input type="checkbox" name="remember[]" id="remember_y" '</span> +
             <span class="hljs-string">'value="y" /&gt; &lt;label for="remember_y"&gt;Remember&lt;/label&gt;'</span>
      expect(subject.checkbox(<span class="hljs-symbol">:remember</span>, { <span class="hljs-symbol">y:</span> <span class="hljs-symbol">:Remember</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set default value from params for single valued checkbox'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">remember:</span> [<span class="hljs-string">'y'</span>] }
      rslt = <span class="hljs-string">'&lt;input type="checkbox" name="remember[]" id="remember_y" '</span> +
             <span class="hljs-string">'value="y" checked="checked" /&gt; '</span> +
             <span class="hljs-string">'&lt;label for="remember_y"&gt;Remember&lt;/label&gt;'</span>
      expect(subject.checkbox(<span class="hljs-symbol">:remember</span>, { <span class="hljs-symbol">y:</span> <span class="hljs-symbol">:Remember</span> })).to eq(rslt)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set default from object'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.hobby = [<span class="hljs-symbol">:sleeping</span>, <span class="hljs-symbol">:dancing</span>]
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|

        <span class="hljs-variable">@out</span> = f.checkbox <span class="hljs-symbol">:hobby</span>,
                          { <span class="hljs-symbol">sleeping:</span> <span class="hljs-symbol">:Sleep</span>, <span class="hljs-symbol">singing:</span> <span class="hljs-symbol">:Sing</span>, <span class="hljs-symbol">dancing:</span> <span class="hljs-symbol">:Dance</span> }
        <span class="hljs-variable">@out</span> &lt;&lt; f.submit
      <span class="hljs-keyword">end</span>
      inp = <span class="hljs-string">'&lt;input type="checkbox" name="user_mock\[hobby\]\[\]"'</span> +
            <span class="hljs-string">' id="user_mock_hobby_'</span>
      expect(rslt).to match(inp + <span class="hljs-string">'sleeping" value="sleeping" checked'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'singing" value="singing" /&gt;'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'dancing" value="dancing" checked'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'prefers default values from params'</span> <span class="hljs-keyword">do</span>
      subject.params = { <span class="hljs-symbol">user_mock:</span> { <span class="hljs-symbol">hobby:</span> [<span class="hljs-symbol">:singing</span>] } }
      user = <span class="hljs-constant">UserMock</span>.new
      user.hobby = [<span class="hljs-symbol">:sleeping</span>, <span class="hljs-symbol">:dancing</span>]
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        <span class="hljs-variable">@out</span> = f.checkbox <span class="hljs-symbol">:hobby</span>,
                          { <span class="hljs-symbol">sleeping:</span> <span class="hljs-symbol">:Sleep</span>, <span class="hljs-symbol">singing:</span> <span class="hljs-symbol">:Sing</span>, <span class="hljs-symbol">dancing:</span> <span class="hljs-symbol">:Dance</span> }
        <span class="hljs-variable">@out</span> &lt;&lt; f.submit
      <span class="hljs-keyword">end</span>
      inp = <span class="hljs-string">'&lt;input type="checkbox" name="user_mock\[hobby\]\[\]"'</span> +
            <span class="hljs-string">' id="user_mock_hobby_'</span>
      expect(rslt).to match(inp + <span class="hljs-string">'sleeping" value="sleeping" /&gt;'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'singing" value="singing" checked'</span>)
      expect(rslt).to match(inp + <span class="hljs-string">'dancing" value="dancing" /&gt;'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#select'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'create simple select box'</span> <span class="hljs-keyword">do</span>
      rslt = subject.select <span class="hljs-symbol">:year</span>, [<span class="hljs-number">1988</span>, <span class="hljs-number">1989</span>, <span class="hljs-number">1990</span>]
      expect(rslt).to match(<span class="hljs-string">'&lt;select name="year"'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;option id="year_1988" value="1988"&gt;1988&lt;/option&gt;'</span>)
    <span class="hljs-keyword">end</span>

    it <span class="hljs-string">'set default values from an object'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.age = <span class="hljs-number">30</span>
      rslt = subject.form <span class="hljs-keyword">do</span>
        subject.fieldset_for(user) <span class="hljs-keyword">do</span> |f|
          <span class="hljs-variable">@out</span> = f.select <span class="hljs-symbol">:age</span>, (<span class="hljs-number">1</span> .. <span class="hljs-number">100</span>).to_a
          <span class="hljs-variable">@out</span> &lt;&lt; f.submit
        <span class="hljs-keyword">end</span>
      <span class="hljs-keyword">end</span>
      expect(rslt).to match(<span class="hljs-string">'&lt;select name="user_mock\[age\]"'</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;option id="user_mock_age_10" value="10"&gt;10&lt;/option&gt;'</span>)
      seld = <span class="hljs-string">'&lt;option id="user_mock_age_30" value="30"'</span> +
             <span class="hljs-string">' selected="selected"&gt;30&lt;/option&gt;'</span>
      expect(rslt).to match(seld)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>

  describe <span class="hljs-string">'#field_group'</span> <span class="hljs-keyword">do</span>
    it <span class="hljs-string">'render a group/label/input set for an given object'</span> <span class="hljs-keyword">do</span>
      user = <span class="hljs-constant">UserMock</span>.new
      user.name = <span class="hljs-string">'What Name'</span>
      rslt = subject.form_for(user) <span class="hljs-keyword">do</span> |f|
        <span class="hljs-variable">@out</span> = f.field_group(<span class="hljs-symbol">:name</span>)
        <span class="hljs-variable">@out</span> &lt;&lt; f.field_group(<span class="hljs-symbol">:age</span>)
      <span class="hljs-keyword">end</span>

      expect(rslt).to match(<span class="hljs-string">'&lt;form '</span>)
      expect(rslt).to match(<span class="hljs-string">'&lt;div class="form-group"&gt;'</span>) <span class="hljs-comment"># +</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <pre><code>              <span class="hljs-string">'&lt;label class="control-label" for="user_mock_name"&gt;'</span>)
</code></pre><h1 id="expect-rslt-to-match-div-class-form-group-has-error-">expect(rslt).to match(‘<div class="form-group has-error">‘ +</h1>
<pre><code>              <span class="hljs-string">'&lt;label class="control-label" for="user_mock_age"'</span>)
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>      expect(rslt).to match(<span class="hljs-string">'id="user_mock_name" class="form-control"'</span> +
                            <span class="hljs-string">' value="What Name"'</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
