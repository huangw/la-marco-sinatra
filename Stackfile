# vi: ft=ruby

attrs application_code: 'la_marco_sinatra',
      application_name: 'Sinatra Based Web Framework',
      application_version: '0.0.1'

pull :'la-marco', git: 'git@gitlab.7lime.com:vikkr/la-marco.git',
                  branch: :develop

from :'la-marco' do
  import :full
end

export :route do
  add_gem 'sinatra', '~> 1.4'
  add_gem 'puma'

  copy 'config/routes.rb'
  copy 'config.ru'
  add_gem 'guard-rake', group: :development # for puma restart

  copy 'lib/tasks/puma.rake'
  copy 'Guardfile', sync: false
end

export :i18n do
  # I18n support
  add_gem 'i18n'
  add_gem 'iye', group: :development               # translate console
  add_gem 'google-translate', group: :development  # find translate from google

  copy 'lib/tasks/i18n.rake'
end

export :web do
  import :route
  import :i18n
  add_gem 'sinatra-contrib'
  add_gem 'sinatra-flash'
  add_gem 'sinatra-redirect-with-flash'
  add_gem 'slim'

  add_gem 'http_accept_language'

  copy 'lib/tasks/i18n_view.rake'
  copy 'lib/helpers/*_helper.rb'
  copy 'app/pages/web_application.rb'
end

export :cucumber do
  add_gem 'guard-cucumber', group: :development

  add_gem 'cucumber', group: :development
  add_gem 'capybara', group: :development
  add_gem 'poltergeist', group: :development
  add_gem 'selenium-webdriver', group: :development

  copy 'features/step_definitions/*_steps.rb'
  copy 'features/support/env.rb'
end

export :assets_mapper do
  add_gem 'git', group: :development
  add_gem 'fastimage', group: :development


  copy 'lib/assets_settings.rb'
  copy 'lib/helpers/assets_helper.rb'
  # copy 'lib/controllers/assets_controller.rb'
  # copy 'lib/controllers/img_controller.rb'

  copy 'lib/tasks/assets.rake'
  # copy 'lib/development/assets_mapper.rb'
  # copy 'lib/development/assets_mapper/*.rb'
  # copy 'app/assets/mappings.rb.sample' => 'app/assets/mappings.rb'
end

from('.') do
  import :web
  import :cucumber
  import :assets_mapper
end
