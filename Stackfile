# vi: ft=ruby

attrs application_code: 'la_marco_sinatra',
      application_name: 'Sinatra Based Web Framework',
      application_version: '0.0.1'

pull :'la-marco', git: 'git@gitlab.7lime.com:vikkr/la-marco.git',
                  branch: :develop

from :'la-marco' do
  import :full
end

export :route do
  add_gem 'sinatra', '~> 1.4'
  add_gem 'puma'

  copy 'config/routes.rb'
  copy 'config.ru'
  add_gem 'guard-rake', group: :development # for puma restart

  copy 'lib/tasks/puma.rake'
  copy 'Guardfile', sync: false
end

export :web do
  import :route
  add_gem 'sinatra-contrib'
  add_gem 'sinatra-flash'
  add_gem 'sinatra-redirect-with-flash'
  add_gem 'slim'

  # I18n support
  add_gem 'i18n'
  add_gem 'http_accept_language'
  add_gem 'iye', group: :development               # translate console
  add_gem 'vine', group: :development              # nested hash
  add_gem 'google-translate', group: :development  # find translate from google

  copy 'lib/helpers/slim_helper.rb'
  copy 'app/pages/web_application.rb'
end

export :cucumber do
  add_gem 'rack-test', group: :development
  add_gem 'guard-cucumber', group: :development

  add_gem 'cucumber', group: :development
  add_gem 'capybara', group: :development
  add_gem 'poltergeist', group: :development
  add_gem 'selenium-webdriver', group: :development

  copy 'features/step_definitions/*_steps.rb'
  copy 'features/support/env.rb'
end

from('.') do
  import :web
  import :cucumber
end
